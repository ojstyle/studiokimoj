<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì¹œêµ¬ ëª¨ì„ ì •ì‚°í‘œ</title>
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <style>
        /* --- ê¸°ë³¸ ìŠ¤íƒ€ì¼ --- */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            margin: 0;
            padding: 20px;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        
        .container {
            width: 100%;
            max-width: 800px;
            margin: 20px auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            backdrop-filter: blur(10px);
            box-sizing: border-box;
        }
        
        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 30px;
            font-size: 2.2em;
            background: linear-gradient(45deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            word-break: keep-all;
        }
        
        .section {
            background: white;
            padding: 25px;
            margin: 20px 0;
            border-radius: 15px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.08);
            border: 1px solid rgba(102, 126, 234, 0.1);
        }
        
        .section h2 {
            color: #555;
            margin-bottom: 20px;
            font-size: 1.4em;
            border-bottom: 2px solid #667eea;
            padding-bottom: 10px;
        }
        
        .input-group {
            display: flex;
            gap: 15px;
            margin: 15px 0;
            align-items: center;
            flex-wrap: wrap;
        }
        
        .input-group label {
            font-weight: 600;
            color: #555;
            min-width: 100px;
            flex-shrink: 0;
        }
        
        input[type="text"], input[type="number"], select {
            flex-grow: 1;
            padding: 12px 15px;
            border: 2px solid #e1e5e9;
            border-radius: 10px;
            font-size: 16px;
            transition: all 0.3s ease;
            background: #fafbfc;
            min-width: 0;
        }
        
        input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
            background: white;
        }
        
        button {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
            width: auto;
            flex-shrink: 0;
        }
        
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
        }

        /* í•˜ë‹¨ ì•¡ì…˜ ë²„íŠ¼ë“¤ */
        .action-buttons {
            display: flex;
            gap: 10px;
            margin-top: 15px;
            flex-wrap: wrap;
        }
        .save-btn {
            background: linear-gradient(45deg, #11998e, #38ef7d);
            flex: 1;
        }
        .share-link-btn {
            background: linear-gradient(45deg, #FF512F, #DD2476);
            flex: 1;
        }
        
        /* ë¦¬ìŠ¤íŠ¸ ìŠ¤íƒ€ì¼ */
        .person-item, .activity-item {
            background: #f8f9ff;
            padding: 15px;
            margin: 10px 0;
            border-radius: 10px;
            border-left: 4px solid #667eea;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s ease;
            flex-wrap: wrap;
            gap: 10px;
        }
        .activity-item { border-left: 4px solid #764ba2; }
        
        .person-info { flex: 1; min-width: 150px; }
        .person-amount {
            font-size: 1.2em;
            font-weight: bold;
            color: #667eea;
            text-align: right;
            flex-shrink: 0;
        }
        
        .total-section {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            text-align: center;
            padding: 25px;
            border-radius: 15px;
            margin-top: 20px;
        }
        .total-amount { font-size: 2em; font-weight: bold; margin: 10px 0; }
        
        .remove-btn {
            background: #ff4757;
            padding: 8px 15px;
            font-size: 14px;
            margin-left: 10px;
            box-shadow: none;
        }
        
        .activity-item input[type="text"] { flex: 2; }
        .activity-item input[type="number"] { flex: 1; }

        #activitiesList { max-height: 300px; overflow-y: auto; padding-right: 10px; }
        #resultsList { max-height: none; overflow-y: visible; padding-right: 0; }

        /* ì€í–‰ ì•± ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
        .banking-apps {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-top: 15px;
            flex-wrap: wrap;
        }
        .bank-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 12px 15px;
            border-radius: 8px;
            font-size: 0.95em;
            color: #333;
            background: white;
            border: 1px solid #eee;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            cursor: pointer;
            flex: 1;
            min-width: 80px;
            transition: transform 0.2s;
            text-decoration: none; /* ë§í¬ ìŠ¤íƒ€ì¼ ì œê±° */
        }
        .bank-btn:hover { transform: translateY(-2px); background: #f0f0f0; }
        .bank-btn.toss { color: #0064FF; font-weight: bold; border: 1px solid #e5e9f2; }
        .bank-btn.kakao { color: #3C1E1E; background: #FAE100; border-color: #FAE100; font-weight: bold;}
        .bank-btn.copy { background: #555; color: white; border-color: #555; }

        /* ëª¨ë°”ì¼ ìµœì í™” */
        @media (max-width: 768px) {
            body { padding: 10px; }
            .container { padding: 20px; }
            h1 { font-size: 1.8em; }
            .input-group { flex-direction: column; align-items: stretch; gap: 10px; }
            .input-group label { text-align: left; }
            button { width: 100%; margin-top: 5px; }
            .action-buttons { flex-direction: column; }
            .activity-item, .person-item { flex-direction: column; align-items: stretch; }
            .person-info, .person-amount { text-align: left; }
            .remove-btn { width: 100%; margin-left: 0; margin-top: 10px; }
            .activity-item input { width: 100%; }
        }
        
        /* ê³µìœ ëœ ë§í¬ë¡œ ë“¤ì–´ì™”ì„ ë•Œ ìˆ˜ì • ë¶ˆê°€ëŠ¥í•˜ê²Œ ì‚´ì§ ê°€ë¦¬ëŠ” ì˜¤ë²„ë ˆì´ (ì„ íƒì‚¬í•­) */
        .readonly-mode input, .readonly-mode .remove-btn {
            pointer-events: none;
            background-color: #eee;
            color: #999;
            opacity: 0.7;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ’° ì˜¤ì œì´ì˜ ì—”ë¹µ ê³„ì‚°ê¸°</h1>
        
        <div class="section">
            <h2>ğŸ¦ ì£¼ìµœì ì •ë³´</h2>
            <div class="input-group">
                <label for="hostName">ì£¼ìµœì ì´ë¦„:</label>
                <input type="text" id="hostName" placeholder="ì´ë¦„ ì…ë ¥">
            </div>
            <div class="input-group">
                <label for="bankName">ì€í–‰ëª…:</label>
                <input type="text" id="bankName" placeholder="ì˜ˆ: êµ­ë¯¼, ì‹ í•œ, í† ìŠ¤">
            </div>
            <div class="input-group">
                <label for="accountNumber">ê³„ì¢Œë²ˆí˜¸:</label>
                <input type="number" id="accountNumber" placeholder="ìˆ«ìë§Œ ì…ë ¥">
            </div>
            <button onclick="updateHostInfo()">ì£¼ìµœì ì •ë³´ ì €ì¥</button>
        </div>
        
        <div class="section">
            <h2>ğŸ“ í™œë™ ì¶”ê°€</h2>
            <div class="activity-item">
                <input type="text" id="activityName" placeholder="í™œë™ëª… (ì˜ˆ: 1ì°¨, 2ì°¨)">
                <input type="number" id="activityCost" placeholder="ë¹„ìš©">
                <button onclick="addActivity()">ì¶”ê°€</button>
            </div>
            <div id="activitiesList"></div>
        </div>
        
        <div class="section">
            <h2>ğŸ‘¥ ì°¸ê°€ì ì¶”ê°€</h2>
            <div class="input-group">
                <label for="personName">ì´ë¦„:</label>
                <input type="text" id="personName" placeholder="ì°¸ê°€ì ì´ë¦„">
            </div>
            <div class="input-group">
                <label>ì°¸ì—¬ í™œë™:</label>
                <div id="participationCheckboxes" style="flex-basis: 100%; margin-top: 10px;">
                    <p style="color:#777;">ë¨¼ì € í™œë™ì„ ì¶”ê°€í•´ì£¼ì„¸ìš”!</p>
                </div>
            </div>
            <button onclick="addPerson()">ì°¸ê°€ì ì¶”ê°€</button>
        </div>
        
        <div class="section">
            <h2>ğŸ’° ì •ì‚° ê²°ê³¼</h2>
            
            <div id="captureArea" style="background:white; padding:10px; border-radius:10px;">
                <div id="summarySection" style="background: #f8f9ff; padding: 15px; border-radius: 10px; margin-bottom: 20px; border-left: 4px solid #667eea; display: none;">
                    <div style="font-size: 1.1em; color: #333;">
                        <strong>ğŸ“Š ì´ ë‚´ì—­:</strong> <span id="activitySummary" style="color: #667eea; font-weight: bold;"></span>
                    </div>
                </div>
                
                <div id="hostInfoDisplay" style="background: linear-gradient(135deg, #667eea, #764ba2); color: white; padding: 20px; border-radius: 15px; margin-bottom: 20px; text-align: center; display: none;">
                    <h3 style="margin: 0 0 15px 0; font-size: 1.3em;">ğŸ’³ ì…ê¸ˆ ì •ë³´</h3>
                    <div style="margin: 10px 0;">
                        <strong>ì£¼ìµœì:</strong> <span id="displayHostName">-</span> / 
                        <strong>ì€í–‰:</strong> <span id="displayBankName">-</span>
                    </div>
                    <div style="font-size: 1.3em; margin: 15px 0; padding: 15px; background: rgba(255,255,255,0.2); border-radius: 10px; font-family: monospace;">
                        <strong id="displayAccountNumber">ê³„ì¢Œë²ˆí˜¸</strong>
                    </div>
                    
                    <div class="banking-apps" data-html2canvas-ignore="true">
                        <button class="bank-btn copy" onclick="copyAccount()">ğŸ“‹ ë³µì‚¬</button>
                        <button class="bank-btn toss" onclick="copyAndOpen('toss')">Toss ì—´ê¸°</button>
                        <button class="bank-btn kakao" onclick="copyAndOpen('kakao')">ì¹´ì¹´ì˜¤ë±…í¬</button>
                    </div>

                    <div style="font-size: 0.9em; opacity: 0.9; margin-top: 15px;">
                        âœ¨ ìœ„ ë²„íŠ¼ì„ ëˆŒëŸ¬ ë°”ë¡œ ì†¡ê¸ˆí•˜ì„¸ìš”!
                    </div>
                </div>
                
                <div id="resultsList"></div>
                
                <div class="total-section">
                    <div>ì´ ëª¨ì„ ë¹„ìš©</div>
                    <div class="total-amount" id="totalAmount">0ì›</div>
                </div>
                
                <div id="captureFooter" style="display:none; text-align:center; margin-top:20px; color:#888; font-size:0.8em;">
                    ì˜¤ì œì´ì˜ ì—”ë¹µ ê³„ì‚°ê¸° ê²°ê³¼
                </div>
            </div>
            <div class="action-buttons">
                <button class="share-link-btn" onclick="generateShareLink()">ğŸ”— ì •ì‚° ë§í¬ ë³µì‚¬í•˜ê¸°</button>
                <button class="save-btn" onclick="saveAsImage()">ğŸ“¸ ì´ë¯¸ì§€ë¡œ ì €ì¥í•˜ê¸°</button>
            </div>
            <p style="text-align:center; color:#888; font-size:0.8em; margin-top:10px;">
                * 'ì •ì‚° ë§í¬'ë¥¼ ê³µìœ í•˜ë©´ ì¹œêµ¬ë“¤ì´ ì´ ë‚´ìš©ì„ ë°”ë¡œ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
            </p>
        </div>
    </div>

    <script>
        // ë°ì´í„° ë³€ìˆ˜
        let activities = [];
        let people = [];
        let hostInfo = { name: '', bank: '', account: '' };
        
        // -------------------------------------------------------
        // â˜… í•µì‹¬ ê¸°ëŠ¥: URL ê³µìœ  ë° ë³µêµ¬ â˜…
        // -------------------------------------------------------
        
        // 1. í˜„ì¬ ìƒíƒœë¥¼ ì••ì¶•í•´ì„œ URL ë§í¬ë¡œ ìƒì„± ë° ë³µì‚¬
        function generateShareLink() {
            if(activities.length === 0 && people.length === 0) {
                alert("ê³µìœ í•  ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤!");
                return;
            }

            // ë°ì´í„°ë¥¼ ê°ì²´ë¡œ ë¬¶ìŒ
            const allData = {
                h: hostInfo, // h: hostInfo ì¤„ì„
                a: activities, // a: activities
                p: people // p: people
            };

            // JSON ë¬¸ìì—´ë¡œ ë³€í™˜ í›„ URL ì¸ì½”ë”©
            try {
                const jsonString = JSON.stringify(allData);
                const encodedData = encodeURIComponent(jsonString);
                
                // í˜„ì¬ í˜ì´ì§€ ì£¼ì†Œ + ?data=ì•”í˜¸í™”ëœë°ì´í„°
                const shareUrl = `${window.location.origin}${window.location.pathname}?data=${encodedData}`;
                
                // í´ë¦½ë³´ë“œ ë³µì‚¬
                navigator.clipboard.writeText(shareUrl).then(() => {
                    alert("ğŸ”— ë§í¬ê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!\n\nì¹´ì¹´ì˜¤í†¡ ë“±ì— ë¶™ì—¬ë„£ê¸°(Ctrl+V)í•˜ì—¬ ê³µìœ í•˜ì„¸ìš”.\nì¹œêµ¬ë“¤ì´ ë§í¬ë¥¼ í´ë¦­í•˜ë©´ ì´ ë‚´ìš© ê·¸ëŒ€ë¡œ ë³´ì…ë‹ˆë‹¤.");
                }).catch(() => {
                    // ë³µì‚¬ ì‹¤íŒ¨ì‹œ(ë³´ì•ˆìƒ ì´ìœ  ë“±) ìˆ˜ë™ ì°½ ë„ìš°ê¸°
                    prompt("ì•„ë˜ ë§í¬ë¥¼ ë³µì‚¬í•´ì„œ ê³µìœ í•˜ì„¸ìš”:", shareUrl);
                });

            } catch (e) {
                console.error(e);
                alert("ë§í¬ ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
            }
        }

        // 2. í˜ì´ì§€ ë¡œë“œ ì‹œ URLì— ë°ì´í„°ê°€ ìˆëŠ”ì§€ í™•ì¸í•˜ê³  ë³µêµ¬
        function checkUrlForData() {
            const params = new URLSearchParams(window.location.search);
            const dataStr = params.get('data');

            if (dataStr) {
                try {
                    // ë°ì´í„° ë³µí˜¸í™” ë° íŒŒì‹±
                    const decodedString = decodeURIComponent(dataStr);
                    const loadedData = JSON.parse(decodedString);

                    // ë°ì´í„° ë³µêµ¬
                    if(loadedData.h) hostInfo = loadedData.h;
                    if(loadedData.a) activities = loadedData.a;
                    if(loadedData.p) people = loadedData.p;

                    // í™”ë©´(UI)ì— ê°’ ì±„ì›Œë„£ê¸°
                    document.getElementById('hostName').value = hostInfo.name || '';
                    document.getElementById('bankName').value = hostInfo.bank || '';
                    document.getElementById('accountNumber').value = hostInfo.account || '';
                    
                    // í™”ë©´ ê°±ì‹  í•¨ìˆ˜ë“¤ í˜¸ì¶œ
                    updateHostInfoDisplay();
                    updateActivitiesList();
                    updateParticipationCheckboxes();
                    calculateResults();

                    alert("ê³µìœ ë°›ì€ ì •ì‚° ë‚´ì—­ì„ ë¶ˆëŸ¬ì™”ìŠµë‹ˆë‹¤! ğŸ’°");

                } catch (e) {
                    console.error(e);
                    alert("ë§í¬ ë°ì´í„°ê°€ ì†ìƒë˜ì–´ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
                }
            }
        }

        // -------------------------------------------------------
        // ê¸°ì¡´ ê¸°ëŠ¥ë“¤
        // -------------------------------------------------------

        function updateHostInfo() {
            const name = document.getElementById('hostName').value.trim();
            const bank = document.getElementById('bankName').value.trim();
            const account = document.getElementById('accountNumber').value.trim();
            
            if (!name || !bank || !account) {
                alert('ì£¼ìµœì ì •ë³´ë¥¼ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”!');
                return;
            }
            hostInfo = { name, bank, account };
            updateHostInfoDisplay();
            alert('ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!');
        }
        
        function updateHostInfoDisplay() {
            const display = document.getElementById('hostInfoDisplay');
            if (hostInfo.name && hostInfo.bank && hostInfo.account) {
                display.style.display = 'block';
                document.getElementById('displayHostName').textContent = hostInfo.name;
                document.getElementById('displayBankName').textContent = hostInfo.bank;
                document.getElementById('displayAccountNumber').textContent = hostInfo.account;
            } else {
                display.style.display = 'none';
            }
        }

        // ê³„ì¢Œ ë³µì‚¬
        function copyAccount() {
            if (!hostInfo.account) return alert("ê³„ì¢Œë²ˆí˜¸ê°€ ì—†ìŠµë‹ˆë‹¤.");
            const temp = document.createElement("textarea");
            temp.value = hostInfo.account;
            document.body.appendChild(temp);
            temp.select();
            document.execCommand("copy");
            document.body.removeChild(temp);
            alert("ê³„ì¢Œë²ˆí˜¸ê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!");
        }

        // ì•± ì—´ê¸°
        function copyAndOpen(app) {
            if (!hostInfo.account) return alert("ê³„ì¢Œë²ˆí˜¸ê°€ ì—†ìŠµë‹ˆë‹¤.");
            
            copyAccount(); // 1. ë³µì‚¬

            setTimeout(() => { // 2. ì•± ì‹¤í–‰
                if (app === 'toss') {
                    location.href = 'supertoss://';
                } else if (app === 'kakao') {
                    location.href = 'kakaobank://';
                }
            }, 500);
        }
        
        function addActivity() {
            const name = document.getElementById('activityName').value.trim();
            const cost = parseInt(document.getElementById('activityCost').value) || 0;
            if (!name || cost <= 0) return alert('í™œë™ëª…ê³¼ ë¹„ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”!');
            
            activities.push({ name, cost });
            updateActivitiesList();
            updateParticipationCheckboxes();
            calculateResults();
            
            document.getElementById('activityName').value = '';
            document.getElementById('activityCost').value = '';
        }
        
        function removeActivity(index) {
            activities.splice(index, 1);
            people.forEach(p => {
                p.activities = p.activities.filter(i => i !== index).map(i => i > index ? i - 1 : i);
            });
            updateActivitiesList();
            updateParticipationCheckboxes();
            calculateResults();
        }
        
        function updateActivitiesList() {
            const list = document.getElementById('activitiesList');
            if (activities.length === 0) {
                list.innerHTML = '<p style="color:#777; text-align:center;">ì¶”ê°€ëœ í™œë™ì´ ì—†ìŠµë‹ˆë‹¤.</p>';
                return;
            }
            list.innerHTML = activities.map((act, i) => `
                <div class="activity-item">
                    <span style="flex:2; font-weight:bold;">${act.name}</span>
                    <span style="flex:1; text-align:right; color:#667eea; font-weight:bold;">${act.cost.toLocaleString()}ì›</span>
                    <button class="remove-btn" onclick="removeActivity(${i})">ì‚­ì œ</button>
                </div>
            `).join('');
        }
        
        function updateParticipationCheckboxes() {
            const container = document.getElementById('participationCheckboxes');
            if (activities.length === 0) {
                container.innerHTML = '<p style="color:#777;">ë¨¼ì € í™œë™ì„ ì¶”ê°€í•´ì£¼ì„¸ìš”!</p>';
                return;
            }
            container.innerHTML = activities.map((act, i) => `
                <label style="display:flex; align-items:center; margin:8px 0; cursor:pointer;">
                    <input type="checkbox" id="activity_${i}" style="margin-right:10px; transform:scale(1.2);">
                    <span>${act.name} (${act.cost.toLocaleString()}ì›)</span>
                </label>
            `).join('');
        }
        
        function addPerson() {
            const name = document.getElementById('personName').value.trim();
            if (!name) return alert('ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”!');
            if (activities.length === 0) return alert('í™œë™ì„ ë¨¼ì € ì¶”ê°€í•´ì£¼ì„¸ìš”!');
            
            const checkedActs = [];
            activities.forEach((_, i) => {
                if (document.getElementById(`activity_${i}`).checked) checkedActs.push(i);
            });
            if (checkedActs.length === 0) return alert('ìµœì†Œ í•˜ë‚˜ì˜ í™œë™ì— ì°¸ì—¬í•´ì•¼ í•©ë‹ˆë‹¤.');
            
            people.push({ name, activities: checkedActs });
            calculateResults();
            
            document.getElementById('personName').value = '';
            activities.forEach((_, i) => document.getElementById(`activity_${i}`).checked = false);
        }
        
        function removePerson(index) {
            people.splice(index, 1);
            calculateResults();
        }
        
        function calculateResults() {
            const resultsList = document.getElementById('resultsList');
            const totalEl = document.getElementById('totalAmount');
            const summarySec = document.getElementById('summarySection');
            
            if (activities.length > 0) {
                summarySec.style.display = 'block';
                document.getElementById('activitySummary').textContent = activities.map(a => `${a.name}:${a.cost.toLocaleString()}`).join(' / ');
            } else {
                summarySec.style.display = 'none';
            }
            
            if (people.length === 0) {
                resultsList.innerHTML = '<p style="color:#777; text-align:center;">ì°¸ê°€ìë¥¼ ì¶”ê°€í•´ì£¼ì„¸ìš”!</p>';
                totalEl.textContent = '0ì›';
                return;
            }
            
            let grandTotal = 0;
            const html = people.map((p, idx) => {
                let myCost = 0;
                const details = [];
                p.activities.forEach(actIdx => {
                    const act = activities[actIdx];
                    if (act) {
                        const count = people.filter(person => person.activities.includes(actIdx)).length;
                        const splitCost = Math.floor(act.cost / count);
                        myCost += splitCost;
                        details.push(`${act.name}(${splitCost.toLocaleString()})`);
                    }
                });
                grandTotal += myCost;
                
                return `
                <div class="person-item">
                    <div class="person-info">
                        <div class="person-name">${p.name}</div>
                        <div class="person-participation" style="font-size:0.85em; color:#666;">
                            ${details.join(', ')}
                        </div>
                    </div>
                    <div class="person-amount">${myCost.toLocaleString()}ì›</div>
                    <button class="remove-btn" data-html2canvas-ignore="true" onclick="removePerson(${idx})">ì‚­ì œ</button>
                </div>`;
            }).join('');
            
            resultsList.innerHTML = html;
            totalEl.textContent = grandTotal.toLocaleString() + 'ì›';
        }

        function saveAsImage() {
            const area = document.getElementById("captureArea");
            const footer = document.getElementById("captureFooter");
            footer.style.display = "block";
            
            html2canvas(area, { scale: 2, backgroundColor: "#ffffff", useCORS: true }).then(canvas => {
                footer.style.display = "none";
                const link = document.createElement("a");
                link.download = 'ì •ì‚°ê²°ê³¼.png';
                link.href = canvas.toDataURL("image/png");
                link.click();
            }).catch(() => {
                alert("ì´ë¯¸ì§€ ì €ì¥ ì‹¤íŒ¨");
                footer.style.display = "none";
            });
        }
        
        // â˜… í˜ì´ì§€ ë¡œë“œ ì‹œ ì‹¤í–‰ (URL ë°ì´í„° í™•ì¸) â˜…
        window.onload = function() {
            // 1. ê¸°ë³¸ ë¦¬ìŠ¤íŠ¸ ë Œë”ë§ (ë¹ˆ ìƒíƒœ)
            updateActivitiesList();
            updateParticipationCheckboxes();
            calculateResults();
            updateHostInfoDisplay();

            // 2. URLì— ê³µìœ ëœ ë°ì´í„°ê°€ ìˆëŠ”ì§€ í™•ì¸í•˜ê³  ë®ì–´ì“°ê¸°
            checkUrlForData();
        };
    </script>
</body>
</html>
